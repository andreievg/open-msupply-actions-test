<style>
  {% include "style.css" %}
</style>

<div class="container">
  <table>
    <thead>
      <tr class="heading">
        <td>Code</td>
        <td>Name</td>
        <td>Status</td>
        <td>Consumption ({{arguments.monthlyConsumptionLookBackPeriod | default(value=3)}} months)</td>
        <td>SOH</td>
        <td>AMC ({{arguments.monthlyConsumptionLookBackPeriod | default(value=3)}} months)</td>
        <td>MOS</td>
      </tr>
    </thead>
    <tbody>
      {% for item in data.items.nodes %}
      {% set SOH = item.stats.availableStockOnHand | default(value=0) | round(
      precision=1) %}
      {% set AMC = item.stats.averageMonthlyConsumption | default(value=0) |
      round(precision=1) %}
      {% set MOS = item.stats.availableMonthsOfStockOnHand | default(value=0) | round( precision=1) %}

      <tr>
        <td>{{item.code}}</td>
        <td>{{item.name}}</td>
        <td class="status"> 
          {% if SOH == 0 and AMC == 0 %}
            <span class="out-of-stock">Out of Stock</span>
          {% elif AMC == 0 %}
            <span class="no-consumption">No consumption</span>
          {% elif MOS >= arguments.monthsUnderstock | default(value=0) and MOS
          <= arguments.monthsOverstock | default(value=0) %}
            <span class="well-stocked">Well stocked</span>
          {% elif MOS < arguments.monthsUnderstock | default(value=0) %}
            <span class="understocked">Understocked</span>
          {% elif MOS > arguments.monthsOverstock | default(value=0) %}
            <span class="overstocked">Overstocked</span>
          {% endif %}
        </td>
        <td>{{item.stats.totalConsumption | default(value=0) | round( precision=1)}}</td>
        <td>{{SOH}}</td>
        <td>{{AMC}}</td>
        <td>
          {{item.stats.availableMonthsOfStockOnHand | default(value=0) | round( precision=1)}}
        </td>
        
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
